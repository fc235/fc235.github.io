
<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <title>web每日一题 | 嘉然今天学什么</title>
        <meta name="author" content="fc235" />
        <meta name="description" content="" />
        <meta name="keywords" content="" />
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
        <link rel="icon" href="/images/avatar.jpg" />
        <script src="https://cdn.staticfile.org/vue/3.2.47/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.3.0/css/all.min.css" />
<link rel="stylesheet" href="/css/fonts.min.css" />
<script> const mixins = {}; </script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>


<script src="https://cdn.staticfile.org/highlight.js/11.7.0/highlight.min.js"></script>
<link
    rel="stylesheet"
    href="https://cdn.staticfile.org/highlight.js/11.7.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>



<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

    <meta name="generator" content="Hexo 6.3.0"></head>
    <body>
        <div id="layout">
            <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
            </transition>
            <nav id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <div class="desktop-menu">
        <a class="title" href="/">
            <span>嘉然今天学什么</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </div>
    <div id="mobile-menu">
        <div class="curtain" @click="shouMenuItems = !shouMenuItems" v-show="shouMenuItems"></div>
        <div class="title" @click="shouMenuItems = !shouMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;嘉然今天学什么</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="shouMenuItems">
            
            <a href="/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                </div>
            </a>
            
            <a href="/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                </div>
            </a>
            
            <a href="/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                </div>
            </a>
            
            <a href="/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                </div>
            </a>
            
            <a href="/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>

            <transition name="into">
            <div id="main" v-show="!loading">
                <div class="article">
    <div>
        <h1>web每日一题</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/5/29
        </span>
        
        <span class="category">
            <a href="/categories/CyberSecurity-Learning/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                CyberSecurity Learning
            </a>
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            <span class="tag">
                
                <a href="/tags/ctf/" style="color: #00bcd4">ctf</a>
            </span>
            
            <span class="tag">
                
                <a href="/tags/web/" style="color: #03a9f4">web</a>
            </span>
            
        </span>
        
    </div>
    
    <div class="content" v-pre>
        <h2 id="Web每日一题"><a href="#Web每日一题" class="headerlink" title="Web每日一题"></a>Web每日一题</h2><p><img src="https://cdn.jsdelivr.net/gh/fc235/Images@main/img/202305302203848.png" alt="3"></p>
<h3 id="2023-5-29-ACTF2020-新生赛-BackupFile"><a href="#2023-5-29-ACTF2020-新生赛-BackupFile" class="headerlink" title="2023.5.29 [ACTF2020 新生赛]BackupFile"></a>2023.5.29 <a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[ACTF2020%20%E6%96%B0%E7%94%9F%E8%B5%9B]BackupFile">[ACTF2020 新生赛]BackupFile</a></h3><p>是否查看wp：是</p>
<p><img src="https://cdn.jsdelivr.net/gh/fc235/Images@main/img/202305292351896.png" alt="image-20230529235100863"></p>
<p>要我找备份文件，我考虑了，www、backup、backupfile等文件名以及rar、zip后缀，但是都没有发现，用dirsearch扫目录，发现大多数都429了，但是居然扫出来一个flag.php，访问无果，应该是被解析了，猜想是文件包含，想不到于是搜了wp，发现是index.php.bak，确实没想到，大概是题做少了。下载下来看源码没想到没有文件包含</p>
<pre><code class="php">&lt;?php
include_once &quot;flag.php&quot;;

if(isset($_GET[&#39;key&#39;])) &#123;
    $key = $_GET[&#39;key&#39;];
    if(!is_numeric($key)) &#123;
        exit(&quot;Just num!&quot;);
    &#125;
    $key = intval($key);
    $str = &quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;;
    if($key == $str) &#123;
        echo $flag;
    &#125;
&#125;
else &#123;
    echo &quot;Try to find out source file!&quot;;
&#125;
</code></pre>
<p>也是非常简单的一个代码啊，<code>intval()</code>之后只取123，所以get传入key值即得flag</p>
<h3 id="2023-5-30-RoarCTF-2019-Easy-Calc"><a href="#2023-5-30-RoarCTF-2019-Easy-Calc" class="headerlink" title="2023.5.30  [RoarCTF 2019]Easy Calc"></a>2023.5.30  <a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[RoarCTF%202019]Easy%20Calc">[RoarCTF 2019]Easy Calc</a></h3><p>是否查看wp：是</p>
<p>点开题发现是个计算器，正常1+1是可以计算的，但是复杂一点的算式就无法计算了，猜想是命令执行但是有过滤</p>
<p><img src="https://cdn.jsdelivr.net/gh/fc235/Images@main/img/202305301053069.png" alt="image-20230530105342041"></p>
<p>看源码发现果然有过滤，同时也发现了calc.php</p>
<p><img src="https://cdn.jsdelivr.net/gh/fc235/Images@main/img/202305301054324.png" alt="image-20230530105432300"></p>
<p>进入calc.php会给出代码</p>
<pre><code class="php">&lt;?php
    error_reporting(0);
if(!isset($_GET[&#39;num&#39;]))&#123;
    show_source(__FILE__);
&#125;else&#123;
    $str = $_GET[&#39;num&#39;];
    $blacklist = [&#39; &#39;, &#39;\t&#39;, &#39;\r&#39;, &#39;\n&#39;,&#39;\&#39;&#39;, &#39;&quot;&#39;, &#39;`&#39;, &#39;\[&#39;, &#39;\]&#39;,&#39;\$&#39;,&#39;\\&#39;,&#39;\^&#39;];
    foreach ($blacklist as $blackitem) &#123;
        if (preg_match(&#39;/&#39; . $blackitem . &#39;/m&#39;, $str)) &#123;
            die(&quot;what are you want to do?&quot;);
        &#125;
    &#125;
    eval(&#39;echo &#39;.$str.&#39;;&#39;);
&#125;
?&gt; 
</code></pre>
<p>存在黑名单，试了一会发现我不会饶过，于是查看wp，发现这题要考的是php的字符串解析特性</p>
<blockquote>
<p>php将查询字符串转换为内部$_GET或者关联数组$_POST（例如&#x2F;?foo&#x3D;bar会转为Array([foo] &#x3D; &gt; “bar”)，查询字符串在解析中会将某些字符删除或用下划线替代（例如 &#x2F;?%20news[id%00&#x3D;42]会转为Array[news_id] &#x3D; &gt; 42)</p>
</blockquote>
<p>php需要将所有参数转换为有效的变量名，因此在解析查询字符串的时候，他会删除空白符，将某些字符转换为下划线，所以这里waf不让num传入字母，我们不能让waf检测出字母，所以我们可以在num前加上一个空格，在php解析时就会把这个空格给删去，但是waf因为空格检测不到num参数，所以就可以成功绕过。</p>
<pre><code class="php">/calc.php? num=a
</code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/fc235/Images@main/img/202305301134650.png" alt="image-20230530113426629"></p>
<p>接下来直接只需要找到flag就行</p>
<pre><code class="php">var_dump(scandir(chr(47))) //&#39;/&#39;在blacklist中，所以用ascii转
</code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/fc235/Images@main/img/202305301132639.png" alt="image-20230530113234617"></p>
<p>找到这个flagg，然后用输出flag</p>
<pre><code class="php">var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))
</code></pre>
<h3 id="2023-5-31-极客大挑战-2019-BuyFlag"><a href="#2023-5-31-极客大挑战-2019-BuyFlag" class="headerlink" title="2023.5.31 [极客大挑战 2019]BuyFlag"></a>2023.5.31 <a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019]BuyFlag">[极客大挑战 2019]BuyFlag</a></h3><p>是否查看wp：是</p>
<p>题目本身没什么难度，进去页面发现pay.php，打开后发现首先要是CUIT的学生，然后要有正确的密码，最后要有钱，第一步卡住了，尝试了XFF，client-ip无果，最后看wp发现是改Cookies，改完就显示要password，查看源码，发现提示，考的是弱类型比较，password直接设置为404a即可，最后带上money，却显示数字过长，这里改用科学计数法即可。</p>
<p>更改Cookies</p>
<pre><code class="http">Cookie: user=1
</code></pre>
<p>post提交</p>
<pre><code class="http">password=404a&amp;money=1e9
</code></pre>
<h3 id="2023-6-1-BJDCTF2020-Easy-MD5"><a href="#2023-6-1-BJDCTF2020-Easy-MD5" class="headerlink" title="2023.6.1 [BJDCTF2020]Easy MD5"></a>2023.6.1 <a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[BJDCTF2020]Easy%20MD5">[BJDCTF2020]Easy MD5</a></h3><p>是否查看wp：否</p>
<p>进入页面发现是一个查询，猜测可能是sql注入，但是题目是md5，所以可能包了一层md5，这里用<code>ffifdyop</code>来查询，这个字符串的md5后hex转ascii的前几位刚好是<code>&#39;or&#39;6</code> 正好构成永真。</p>
<p><img src="https://cdn.jsdelivr.net/gh/fc235/Images@main/img/202306010959709.png" alt="image-20230601095909221"></p>
<p>之后进入第二关，查看源码发现提示</p>
<pre><code class="php">$a = $GET[&#39;a&#39;];
$b = $_GET[&#39;b&#39;];
if($a != $b &amp;&amp; md5($a) == md5($b))&#123;
</code></pre>
<p>md5弱类型比较，这里我用数组可以绕过，做完看其他思路发现可以用240610708，aabg7XSs，aabC9RqS，s878926199a等md5后结果是0e开头的字符串绕过。</p>
<p>最后来到新页面，代码已给出</p>
<pre><code class="php"> &lt;?php
error_reporting(0);
include &quot;flag.php&quot;;

highlight_file(__FILE__);

if($_POST[&#39;param1&#39;]!==$_POST[&#39;param2&#39;]&amp;&amp;md5($_POST[&#39;param1&#39;])===md5($_POST[&#39;param2&#39;]))&#123;
    echo $flag;
&#125; 
</code></pre>
<p>是php的强比较，依然可以用数组来绕过，这里post传入</p>
<pre><code class="http">param1[]=1&amp;param2=2
</code></pre>
<p>这样两个md5都是null，但是相等，传入就可以可以得到flag。</p>
<p>还有一种更强的检测，就是将传入数据转为字符串，就是md5的强碰撞，看到两种方法，一种是使用软件fastcoll，直接将a拖入即可得到msg1和2，然后读取12中即可。</p>
<p><img src="https://cdn.jsdelivr.net/gh/fc235/Images@main/img/202306011009918.png" alt="image-20230601100958482"></p>
<p>还有一种是将hex字符串转化为ascii字符串，并写入到bin文件,然后再读取，payload：</p>
<pre><code class="http">a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2
&amp;
b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2
</code></pre>
<p>他们的md5值是相等的，考虑到要将一些不可见字符传到服务器，这里使用url编码。</p>
<h3 id="2023-6-2-护网杯-2018-easy-tornado"><a href="#2023-6-2-护网杯-2018-easy-tornado" class="headerlink" title="2023.6.2 [护网杯 2018]easy_tornado"></a>2023.6.2 <a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[%E6%8A%A4%E7%BD%91%E6%9D%AF%202018]easy_tornado">[护网杯 2018]easy_tornado</a></h3><p>是否查看wp：</p>

    </div>
    
    
    
    
    <div id="comment">
        <div id="giscus-container" class="giscus"></div>
    </div>
    
    
    
    
</div>

                <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2023 - 2023
                    嘉然今天学什么
                        <span id="footer-icon">
                            <i class="fa-solid fa-font-awesome fa-fw"></i>
                        </span>
                        &commat;fc235
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/argvchs/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        

    </div>
</footer>
            </div>
            </transition>
            
            <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
            </transition>
            
        </div>
        <script src="/js/main.js"></script>
        
        
<script
    src="https://giscus.app/client.js"
    data-repo="fc235/comment"
    data-repo-id="R_kgDOJW5fXA"
    data-category="Announcements"
    data-category-id="DIC_kwDOJW5fXM4CVyQR"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="1"
    data-input-position="bottom"
    data-theme="preferred_color_scheme"
    data-lang="zh-CN"
    crossorigin
    async
></script>





        
    </body>
</html>
